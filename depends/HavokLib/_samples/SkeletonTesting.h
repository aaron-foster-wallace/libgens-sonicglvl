#pragma once
static const short parents[] =
{
	-1, -1, 1, 2, 3, 4, 5, 6, 4, 8, 9, 4, 11, 12, 4, 14,
	15, 1, 17, 18, 19, 20, 21, 19, 23, 24, 19, 26, 27, 19, 29, 30,
	1, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,
	44, 48, 49, 44, 51, 52, 39, 54, 55, 56, 57, 58, 59, 60, 58, 62,
	63, 58, 65, 66, 39, 68, 69, 70, 71, 72, 73, 74, 75, 1, 77, 78,
	79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, -1, -1,
};

static const hkQTransform boneTransforms[] = 
{
			hkQTransform{ Vector(0.000000, 0.000000, 0.000000), Vector4(-0.707107, -0.000000, -0.707107, -0.000000), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(-0.000002, 18.224514, 80.507500), Vector4(-0.518764, 0.480504, -0.518764, 0.480504), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(-8.239309, -4.077690, 10.500702), Vector4(-0.808421, -0.586914, -0.017758, 0.040883), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(40.401596, 0.000003, -0.000002), Vector4(-0.000000, -0.000000, -0.279250, 0.960218), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(31.134502, 0.000002, 0.000002), Vector4(-0.011987, -0.042583, 0.497009, 0.866617), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.247398, -0.003639, 3.585818), Vector4(0.120339, -0.194975, 0.019099, 0.973210), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.470001, 0.000000, 0.000003), Vector4(-0.136770, 0.045667, -0.230159, 0.962411), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.710000, -0.000001, 0.000000), Vector4(-0.000000, 0.000000, -0.492321, 0.870414), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(16.249680, -1.957832, 3.504267), Vector4(0.023403, -0.085536, 0.148802, 0.984883), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.880000, 0.000001, 0.000001), Vector4(-0.010173, -0.004418, 0.236565, 0.971552), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.870001, 0.000001, 0.000002), Vector4(0.000000, -0.000000, -0.270446, 0.962735), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(19.708839, 0.344148, -0.546799), Vector4(-0.015832, -0.030516, 0.245746, 0.968724), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.870000, -0.000005, 0.000000), Vector4(-0.009183, 0.009603, 0.153560, 0.988050), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.119998, -0.000005, 0.000000), Vector4(0.005326, -0.007363, -0.240366, 0.970640), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(11.687141, -0.350567, -3.693562), Vector4(-0.023310, 0.071575, -0.014737, 0.997054), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.390000, 0.000005, -0.000004), Vector4(0.008377, -0.000455, 0.245531, 0.969352), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.710001, -0.000003, -0.000004), Vector4(0.001222, 0.000051, -0.046300, 0.998927), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(-8.239309, -4.077690, -10.500698), Vector4(-0.808421, -0.586914, 0.017758, -0.040884), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(40.401600, 0.000002, 0.000002), Vector4(-0.000000, 0.000000, -0.279250, 0.960218), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(31.134502, 0.000000, 0.000000), Vector4(0.011992, 0.042559, 0.496799, 0.866739), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.247400, -0.003639, -3.585819), Vector4(-0.120386, 0.194975, 0.019339, 0.973200), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.470001, 0.000001, -0.000003), Vector4(0.136770, -0.045667, -0.230160, 0.962411), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.710000, -0.000002, 0.000000), Vector4(0.000000, -0.000000, -0.492321, 0.870414), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(16.249683, -1.957831, -3.504265), Vector4(-0.023420, 0.085560, 0.149041, 0.984844), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.880001, 0.000001, -0.000001), Vector4(0.010173, 0.004418, 0.236565, 0.971552), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.870000, 0.000001, -0.000002), Vector4(-0.000000, 0.000000, -0.270446, 0.962735), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(19.708843, 0.344150, 0.546801), Vector4(0.015832, 0.030549, 0.245980, 0.968664), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.870000, -0.000004, 0.000002), Vector4(0.009183, -0.009603, 0.153560, 0.988050), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.119998, -0.000005, 0.000000), Vector4(-0.005326, 0.007363, -0.240366, 0.970640), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(11.687143, -0.350566, 3.693563), Vector4(0.023327, -0.071539, -0.014496, 0.997060), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.389999, 0.000004, 0.000006), Vector4(-0.008377, 0.000455, 0.245531, 0.969352), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.710001, -0.000003, 0.000004), Vector4(-0.001222, -0.000051, -0.046300, 0.998927), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(1.440159, -2.211517, -0.000000), Vector4(0.000000, 0.000000, 0.015052, 0.999887), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308632, 0.000000, 0.000001), Vector4(-0.000000, 0.000000, 0.032132, 0.999484), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308631, 0.000008, -0.000000), Vector4(0.000000, 0.000000, 0.030845, 0.999524), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308631, 0.000000, -0.000000), Vector4(-0.000000, -0.000000, 0.025941, 0.999663), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308630, 0.000000, -0.000000), Vector4(-0.000000, -0.000000, 0.017431, 0.999848), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308630, 0.000000, -0.000000), Vector4(0.000000, 0.000000, 0.005268, 0.999986), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308631, 0.000000, -0.000001), Vector4(-0.000000, 0.000000, -0.010570, 0.999944), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(7.308636, -0.000008, -0.000001), Vector4(-0.000000, -0.000000, -0.012022, 0.999928), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(9.122398, 1.281593, 3.997910), Vector4(0.067193, 0.595899, -0.625547, -0.499080), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(13.209999, -0.000008, -0.000004), Vector4(-0.556068, -0.025938, 0.175042, 0.812081), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(20.855404, 0.000013, -0.000010), Vector4(-0.006127, -0.018832, 0.295057, 0.955274), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(8.090500, 0.000011, 0.000000), Vector4(0.268443, -0.000000, 0.000000, 0.963296), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(8.090504, 0.000009, -0.000006), Vector4(-0.453723, 0.201710, 0.326428, 0.804297), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(1.812120, -1.349606, 2.023743), Vector4(0.070074, -0.091768, 0.007881, 0.993281), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.230003, -0.000004, 0.000005), Vector4(0.000000, -0.000000, -0.036705, 0.999326), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.350002, 0.000000, 0.000003), Vector4(0.000000, -0.000000, -0.562570, 0.826749), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.800005, -0.000004, 0.361102), Vector4(0.058896, -0.016362, 0.076547, 0.995191), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.800003, -0.000008, 0.000002), Vector4(0.016111, -0.039006, -0.215086, 0.975683), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(2.450003, 0.000000, 0.000001), Vector4(-0.075921, 0.012737, -0.157504, 0.984513), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.810905, 0.369339, -2.297554), Vector4(0.000000, 0.041348, 0.000000, 0.999145), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.720003, -0.000004, 0.000002), Vector4(0.000000, -0.000000, -0.131261, 0.991348), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(1.860003, 0.000002, 0.000002), Vector4(0.000000, -0.000000, -0.113699, 0.993515), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(9.122402, 1.281593, -3.997910), Vector4(-0.067193, -0.595899, -0.625547, -0.499080), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(13.209999, -0.000008, 0.000004), Vector4(0.556068, 0.025939, 0.175042, 0.812081), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(20.855404, 0.000015, 0.000006), Vector4(0.006127, 0.018832, 0.295057, 0.955274), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(8.090500, 0.000010, -0.000003), Vector4(-0.268443, 0.000000, 0.000000, 0.963296), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(8.090504, 0.000008, 0.000002), Vector4(0.453723, -0.201710, 0.326428, 0.804297), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(1.812122, -1.349602, -2.023744), Vector4(-0.070074, 0.091768, 0.007881, 0.993281), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.230003, -0.000004, -0.000004), Vector4(-0.000000, 0.000000, -0.036705, 0.999326), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.350002, -0.000002, -0.000004), Vector4(-0.000000, 0.000000, -0.562570, 0.826749), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.800003, 0.000000, -0.361102), Vector4(-0.058896, 0.016362, 0.076547, 0.995191), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(4.800003, -0.000008, -0.000005), Vector4(-0.016111, 0.039006, -0.215086, 0.975683), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(2.450003, 0.000000, -0.000001), Vector4(0.075921, -0.012737, -0.157504, 0.984513), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.810905, 0.369343, 2.297554), Vector4(-0.000000, -0.041348, 0.000000, 0.999145), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(3.720002, -0.000004, -0.000004), Vector4(-0.000000, 0.000000, -0.131261, 0.991348), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(1.860003, 0.000000, -0.000002), Vector4(-0.000000, 0.000000, -0.113699, 0.993515), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(6.107918, -0.467316, -0.000001), Vector4(0.000035, -0.000607, -0.140490, 0.990082), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519299, -0.000008, 0.000000), Vector4(-0.000068, -0.000600, -0.154792, 0.987947), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519295, 0.000004, 0.000000), Vector4(-0.000068, 0.000121, -0.109899, 0.993943), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519302, -0.000008, 0.000000), Vector4(-0.000181, 0.000654, -0.038349, 0.999264), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519295, 0.000004, -0.000000), Vector4(-0.000317, 0.001252, 0.136775, 0.990601), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519302, 0.000008, 0.000000), Vector4(-0.000474, 0.001805, 0.145163, 0.989406), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519295, 0.000008, -0.000000), Vector4(-0.001357, 0.001278, 0.190139, 0.981755), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(5.519299, 0.000000, 0.000000), Vector4(-0.001251, -0.000004, -0.040442, 0.999181), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(0.000000, 0.000000, 0.000000), Vector4(-0.002100, -0.000782, 0.267528, 0.963547), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(-9.585703, -1.449539, -0.100307), Vector4(-0.001850, -0.001385, -0.999929, 0.011650), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101799, 0.000000, 0.000001), Vector4(0.000104, 0.000205, -0.045031, 0.998986), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101803, 0.000008, 0.000000), Vector4(-0.000035, 0.000026, -0.044101, 0.999027), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101799, 0.000000, 0.000000), Vector4(-0.000020, -0.000022, 0.003080, 0.999995), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101799, 0.000000, -0.000000), Vector4(-0.000007, -0.000053, -0.028894, 0.999583), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101799, 0.000000, -0.000001), Vector4(-0.000024, -0.000093, -0.006166, 0.999981), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101799, -0.000008, 0.000001), Vector4(-0.000051, -0.000129, -0.013153, 0.999914), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101807, 0.000008, 0.000001), Vector4(0.000059, 0.000007, 0.015730, 0.999876), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101791, 0.000000, 0.000000), Vector4(0.000096, 0.000070, 0.039078, 0.999236), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101776, 0.000000, 0.000000), Vector4(0.000019, 0.000012, 0.026964, 0.999636), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101791, 0.000000, 0.000000), Vector4(0.000116, 0.004217, 0.025612, 0.999663), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101807, -0.000008, -0.000000), Vector4(-0.000020, 0.000092, 0.029672, 0.999560), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101807, 0.000000, 0.000000), Vector4(0.000059, 0.000160, 0.028988, 0.999580), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(15.101807, -0.000004, 0.000000), Vector4(0.000426, -0.000023, 0.003286, 0.999995), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(16.062000, 0.371881, 0.000001), Vector4(-0.707075, 0.006683, -0.707075, -0.006684), Vector(1.000000f, 1.000000f, 1.000000f) },
			hkQTransform{ Vector(-16.062000, 0.371877, -0.000001), Vector4(-0.707075, -0.006684, -0.707075, 0.006684), Vector(1.000000f, 1.000000f, 1.000000f) },
};

static const char *boneNames[] = 
{
	"Allosaur",
	"AllosaurPelvis",
	"AllosaurLLeg1",
	"AllosaurLLeg2",
	"AllosaurLLegPalm",
	"AllosaurLLegDigit01",
	"AllosaurLLegDigit02",
	"AllosaurLLegDigit03",
	"AllosaurLLegDigit11",
	"AllosaurLLegDigit12",
	"AllosaurLLegDigit13",
	"AllosaurLLegDigit21",
	"AllosaurLLegDigit22",
	"AllosaurLLegDigit23",
	"AllosaurLLegDigit31",
	"AllosaurLLegDigit32",
	"AllosaurLLegDigit33",
	"AllosaurRLeg1",
	"AllosaurRLeg2",
	"AllosaurRLegPalm",
	"AllosaurRLegDigit01",
	"AllosaurRLegDigit02",
	"AllosaurRLegDigit03",
	"AllosaurRLegDigit11",
	"AllosaurRLegDigit12",
	"AllosaurRLegDigit13",
	"AllosaurRLegDigit21",
	"AllosaurRLegDigit22",
	"AllosaurRLegDigit23",
	"AllosaurRLegDigit31",
	"AllosaurRLegDigit32",
	"AllosaurRLegDigit33",
	"AllosaurSpine1",
	"AllosaurSpine2",
	"AllosaurSpine3",
	"AllosaurSpine4",
	"AllosaurSpine5",
	"AllosaurSpine6",
	"AllosaurSpine7",
	"AllosaurRibcage",
	"AllosaurLArmCollarbone",
	"AllosaurLArm1",
	"AllosaurLArm21",
	"AllosaurLArm22",
	"AllosaurLArmPalm",
	"AllosaurLArmDigit01",
	"AllosaurLArmDigit02",
	"AllosaurLArmDigit03",
	"AllosaurLArmDigit11",
	"AllosaurLArmDigit12",
	"AllosaurLArmDigit13",
	"AllosaurLArmDigit21",
	"AllosaurLArmDigit22",
	"AllosaurLArmDigit23",
	"AllosaurRArmCollarbone",
	"AllosaurRArm1",
	"AllosaurRArm21",
	"AllosaurRArm22",
	"AllosaurRArmPalm",
	"AllosaurRArmDigit01",
	"AllosaurRArmDigit02",
	"AllosaurRArmDigit03",
	"AllosaurRArmDigit11",
	"AllosaurRArmDigit12",
	"AllosaurRArmDigit13",
	"AllosaurRArmDigit21",
	"AllosaurRArmDigit22",
	"AllosaurRArmDigit23",
	"AllosaurNeck1",
	"AllosaurNeck2",
	"AllosaurNeck3",
	"AllosaurNeck4",
	"AllosaurNeck5",
	"AllosaurNeck6",
	"AllosaurNeck7",
	"AllosaurHead",
	"AllosaurHeadBone0",
	"AllosaurTail01",
	"AllosaurTail02",
	"AllosaurTail03",
	"AllosaurTail04",
	"AllosaurTail05",
	"AllosaurTail06",
	"AllosaurTail07",
	"AllosaurTail08",
	"AllosaurTail09",
	"AllosaurTail10",
	"AllosaurTail11",
	"AllosaurTail12",
	"AllosaurTail13",
	"AllosaurTail14",
	"AllosaurLLegPlatform",
	"AllosaurRLegPlatform",
};

void TestAllosaurSkeleton(const TSTRING testingPath)
{
	for (auto &v : versions)
		for (auto &t : compiledFlags)
		{
			TSTRING fleName = testingPath;
			fleName.append(v);
			fleName.append(_T("allosaur"));
			fleName.append(t);

			printline("testing: ", << fleName);
			IhkPackFile *hdr = IhkPackFile::Create(fleName.c_str());
			
			if (!hdr)
			{
				printerror("testing failed!");
				continue;
			}

			hkRootLevelContainer *rcont = hdr->GetRootLevelContainer();

			if (!rcont)
			{
				printerror("Couldn't find hkRootLevelContainer!");
				continue;
			}

			const hkaAnimationContainer *aniCont = rcont->GetVariant(0);

			const hkaSkeleton *skel = aniCont->GetSkeleton(0);

			MyAssert(skel->GetNumBones() != 93);

			int cBone = 0;

			for (auto b : skel->FullBones())
			{
				MyAssertLoop(b.parentID != parents[cBone], cBone);
				MyAssertLoop(strcmp(b.name, boneNames[cBone]), cBone);
				MyAssertLoop(*b.transform != boneTransforms[cBone], cBone);
				cBone++;
			}

			delete hdr;
		}
}